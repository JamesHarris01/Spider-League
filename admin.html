<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Spider League</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .nav-bar {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-bar a {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: bold;
            transition: transform 0.2s;
        }

        .nav-bar a:hover {
            transform: translateY(-2px);
        }

        .nav-bar a.active {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a6a0 100%);
        }

        .config-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .config-section h2 {
            margin-bottom: 15px;
            color: #4ecdc4;
        }

        .verification-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .verification-image {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .verification-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
        }

        .verify-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a6a0 100%);
            font-size: 24px;
            padding: 15px 40px;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
        }

        .deny-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            font-size: 24px;
            padding: 15px 40px;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #aaa;
        }

        input {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 14px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }

        .status.success {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
        }

        .status.error {
            background: rgba(245, 87, 108, 0.2);
            border: 1px solid #f5576c;
        }

        .hidden {
            display: none;
        }

        .stat-display {
            margin: 10px 0;
            color: #aaa;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üëë Admin Panel üëë</h1>
            <p>Manage spider submissions and game balance</p>
        </header>

        <div class="nav-bar">
            <a href="index.html">üï∏Ô∏è Collection</a>
            <a href="battle.html">‚öîÔ∏è Battle</a>
            <a href="shop.html">üõí Shop</a>
            <a href="admin.html" class="active">üëë Admin</a>
        </div>

        <div id="accessDenied" class="config-section">
            <h2 style="color: #f5576c;">‚õî Access Denied</h2>
            <p>You must be logged in as "admin" to access this page.</p>
            <p style="margin-top: 10px;"><a href="index.html" style="color: #4ecdc4;">Go back to collection</a></p>
        </div>

        <div id="adminContent" class="hidden">
            <div class="config-section">
                <h2>üîç Spider Verification Queue</h2>
                <p style="color: #aaa; margin-bottom: 20px;">Review and approve spider submissions</p>
                <div id="verificationQueue">
                    <p style="color: #666;">No pending spiders to verify</p>
                </div>
            </div>

            <div class="config-section">
                <h2>‚öñÔ∏è Game Balance Settings</h2>
                <p style="color: #aaa; margin-bottom: 20px;">Configure reward amounts and game mechanics</p>
                
                <div class="input-group">
                    <label>Battle Win Reward (coins):</label>
                    <input type="number" id="adminBattleWinCoins" value="25" min="0">
                </div>

                <div class="input-group">
                    <label>Battle Win XP:</label>
                    <input type="number" id="adminBattleWinXP" value="50" min="0">
                </div>

                <div class="input-group">
                    <label>Spider Submission Reward (coins):</label>
                    <input type="number" id="adminSpiderSubmitCoins" value="50" min="0">
                </div>

                <div class="input-group">
                    <label>XP Required Per Level:</label>
                    <input type="number" id="adminXPPerLevel" value="100" min="1">
                </div>

                <button onclick="saveGameBalance()">Save Balance Settings</button>
                <div id="adminStatus"></div>
            </div>
        </div>
    </div>

    <script src="shared.js"></script>
    <script>
        function checkAdminAccess() {
            if (currentUser === 'admin') {
                document.getElementById('accessDenied').classList.add('hidden');
                document.getElementById('adminContent').classList.remove('hidden');
                updateAdminPanel();
            } else {
                document.getElementById('accessDenied').classList.remove('hidden');
                document.getElementById('adminContent').classList.add('hidden');
            }
        }

        function showStatus(id, msg, type) {
            const el = document.getElementById(id);
            if (!el) return;
            el.textContent = msg;
            el.className = `status ${type}`;
            setTimeout(() => el.className = 'status hidden', 4000);
        }

        function updateAdminPanel() {
            if (currentUser !== 'admin') return;

            const pendingSpiders = spiders.filter(s => s.pending && !s.verified);
            const queueDiv = document.getElementById('verificationQueue');

            if (pendingSpiders.length === 0) {
                queueDiv.innerHTML = '<p style="color: #666;">No pending spiders to verify</p>';
            } else {
                queueDiv.innerHTML = pendingSpiders.map(spider => {
                    const statsHTML = Object.entries(spider.stats).map(([key, value]) => 
                        `<span style="margin: 5px;">${key}: ${value}</span>`
                    ).join(' | ');

                    return `
                        <div class="verification-card">
                            <img src="${spider.image}" class="verification-image" alt="${spider.name}">
                            <h3>${spider.name}</h3>
                            ${spider.latinName ? `<p style="font-style: italic; color: #aaa;">${spider.latinName}</p>` : ''}
                            <p style="color: #aaa; margin-top: 10px;">Submitted by: ${spider.owner}</p>
                            <p style="color: #aaa;">Rarity: ${spider.rarity}</p>
                            <div class="stat-display">
                                ${statsHTML}
                            </div>
                            <div class="verification-actions">
                                <button class="verify-btn" onclick="verifySpider(${spider.id}, true)">‚úì Approve</button>
                                <button class="deny-btn" onclick="verifySpider(${spider.id}, false)">‚úï Deny</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // Load current balance settings
            document.getElementById('adminBattleWinCoins').value = gameBalance.battleWinCoins;
            document.getElementById('adminBattleWinXP').value = gameBalance.battleWinXP;
            document.getElementById('adminSpiderSubmitCoins').value = gameBalance.spiderSubmitCoins;
            document.getElementById('adminXPPerLevel').value = gameBalance.xpPerLevel;
        }

        async function verifySpider(spiderId, approved) {
            const spider = spiders.find(s => s.id === spiderId);
            if (!spider) return;

            if (approved) {
                spider.verified = true;
                spider.pending = false;
                
                const owner = users.find(u => u.username === spider.owner);
                if (owner) {
                    owner.coins = (owner.coins || 0) + gameBalance.spiderSubmitCoins;
                }
                
                showStatus('adminStatus', `Spider approved! ${spider.owner} earned ${gameBalance.spiderSubmitCoins} coins.`, 'success');
            } else {
                spiders = spiders.filter(s => s.id !== spiderId);
                showStatus('adminStatus', 'Spider denied and removed.', 'error');
            }

            await saveData();
            updateAdminPanel();
        }

        async function saveGameBalance() {
            gameBalance.battleWinCoins = parseInt(document.getElementById('adminBattleWinCoins').value);
            gameBalance.battleWinXP = parseInt(document.getElementById('adminBattleWinXP').value);
            gameBalance.spiderSubmitCoins = parseInt(document.getElementById('adminSpiderSubmitCoins').value);
            gameBalance.xpPerLevel = parseInt(document.getElementById('adminXPPerLevel').value);

            if (await saveData()) {
                showStatus('adminStatus', 'Game balance settings saved!', 'success');
            }
        }

        // Initialize
        loadConfig();
        loadData().then(() => {
            checkAdminAccess();
        });

        // Check access periodically in case user logs in
        setInterval(checkAdminAccess, 1000);
    </script>
</body>
</html>